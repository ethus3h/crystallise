#!/bin/bash
source "$(which ember_bash_setup)" &> /dev/null

# Accepts a pointer on stdin, and outputs the corresponding data from the stream cache.

[ "$(whoami)" != "root" ] && exec sudo -- "$0" "$@"
trap 'error-notify "A fatal error was reported on ${BASH_SOURCE} line ${LINENO}."' ERR

crystalWorkdir="$(crystallize-getconf 'WorkDirectory')"
if ! [ -e "$crystalWorkdir/.StreamCache/" ]; then
  scache_init "$crystalWorkdir/.StreamCache/" 5000000000
fi
scache_request < /dev/stdin
